<div class="page">
  <div class="file-area" *ngIf="meta; else noSelected">
    <div
      style="
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      "
    >
      <button mat-raised-button color="accent" (click)="onClickAddPassword()">
        <mat-icon>add</mat-icon>
        password
      </button>
      <div [title]="meta.name">
        <button mat-button class="file" (click)="onClickSelectFile()">
          <mat-icon>text_snippet</mat-icon>{{ selectedFileName }}
        </button>
      </div>
    </div>
  </div>
  <div fxLayout="row" *ngIf="passwords?.length">
    <div #elTagArea class="tag-list" fxHide.lt-sm="true">
      <ul>
        <li *ngFor="let tag of tagsWithNoTagKey">
          <a (click)="onClickTag(tag)">{{ tag }}</a>
        </li>
      </ul>
    </div>
    <div #elPasswordArea class="password-area">
      <ng-container
        *ngTemplateOutlet="
          templatePasswordsEachTag;
          context: { passwords: passwords }
        "
      ></ng-container>
    </div>
  </div>
</div>

<ng-template #noSelected>
  <button mat-raised-button color="accent" (click)="onClickSelectFile()">
    select file
  </button>
</ng-template>

<ng-template #templatePasswordsEachTag>
  <div *ngFor="let tag of tagsWithNoTagKey">
    <h1 [id]="tag" style="margin: 0">{{ tag }}</h1>
    <div>
      <ng-container
        *ngTemplateOutlet="
          templatePasswords;
          context: { passwords: passwordsEachTag[tag] }
        "
      ></ng-container>
    </div>
    <div style="margin-bottom: 20px"></div>
  </div>
</ng-template>

<ng-template #templatePasswords let-passwords="passwords">
  <div fxLayout="row wrap">
    <ng-container *ngFor="let password of passwords; let i = index">
      <app-password-detail
        [password]="password"
        [index]="i"
        [isShowPassword]="isShowPassword"
        [isShowLoginId]="isShowLoginId"
        style="max-width: 100%"
      ></app-password-detail>
    </ng-container>
  </div>
</ng-template>
